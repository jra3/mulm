include ../header.pug

+dialog()
	h2.text-xl.font-extrabold.mb-4 Request Changes
	form.contents#feedbackForm(
		hx-post=`/admin/submissions/${submission.id}/request-changes`
		hx-trigger="submit"
		hx-target="#requestChangesError"
		hx-swap="innerHTML"
		hx-indicator="#feedbackIndicator"
		hx-disabled-elt="#feedbackSubmitBtn"
		hx-on::response-error="this.querySelector('#requestChangesError').textContent = event.detail.xhr.responseText; document.getElementById('feedbackSubmitBtn').disabled = false;"
	)
		span#requestChangesError.text-red-600.font-semibold.text-sm(role="alert" aria-live="polite")
		label.input-label(for="requestChangesText") Changes requested
		textarea.w-full.h-96.bg-white(
			name="content"
			id="requestChangesText"
			required
			minlength="10"
			maxlength="1000"
			aria-label="Feedback requesting changes to submission"
			aria-describedby="requestChangesError"
			aria-required="true"
			placeholder="Provide specific feedback about what needs to be changed..."
		)= contents
		div.flex.items-center.gap-2
			button#feedbackSubmitBtn.primary(type="submit" hx-disabled-elt="this")
				span Send
				+loadingSpinner()
