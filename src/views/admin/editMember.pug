include ../mixins/loadingSpinner.pug
include ../mixins/memberPointsHover.pug

tr(class="bg-blue-50")
	- const stringCell = ['p-3', 'text-left', 'border-b', 'border-gray-200'];
	- const numberCell = ['p-3', 'text-right', 'border-b', 'border-gray-200'];
	- const centerCell = ['p-3', 'text-center', 'border-b', 'border-gray-200'];

	td(class=numberCell)= member.id

	td(class=centerCell)
		input(
			checked=member.is_admin == 1
			name="is_admin"
			type="checkbox"
			class="w-4 h-4")

	td(class=stringCell)
		input(name="display_name" value=member.display_name class="w-full px-2 py-1 border rounded")

	td(class=stringCell)
		input(name="contact_email" value=member.contact_email class="w-full px-2 py-1 border rounded")

	td(class=numberCell)
		- const fishNext = getNextLevel('fish', member.fish_level, member.fishTotalPoints || 0)
		+memberPointsHover(member, 'fish', fishNext, programMetadata.fish)

	td(class=numberCell)
		- const plantNext = getNextLevel('plant', member.plant_level, member.plantTotalPoints || 0)
		+memberPointsHover(member, 'plant', plantNext, programMetadata.plant)

	td(class=numberCell)
		- const coralNext = getNextLevel('coral', member.coral_level, member.coralTotalPoints || 0)
		+memberPointsHover(member, 'coral', coralNext, programMetadata.coral)

	td(class=centerCell)
		.flex.gap-2.items-center.justify-center
			form(
				hx-target="closest tr"
				hx-swap="outerHTML"
				hx-include="closest tr"
				hx-patch=`/admin/members/${member.id}`
				hx-trigger="submit")
				button.primary(type="submit" hx-disabled-elt="this" aria-label="Save member changes")
					span Save
					+loadingSpinner()
			button(
				hx-target="closest tr"
				hx-swap="outerHTML"
				hx-get=`/admin/members/${member.id}/row`
				class="secondary"
				aria-label="Cancel editing") Cancel
