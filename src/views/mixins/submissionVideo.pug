//- Mixin for displaying submission video link with thumbnail
//- Usage: +submissionVideo(submission.video_url, videoMetadata)
//- videoMetadata is optional pre-fetched oEmbed data from the route handler

mixin submissionVideo(videoUrl, videoMetadata)
	if videoUrl
		- const video = videoMetadata || { platform: 'unknown', thumbnailUrl: null };

		if video.platform !== 'unknown' && video.thumbnailUrl
			div(class="mb-6")
				h3(class="text-lg font-bold mb-3 text-gray-900")
					| Video
					if video.title
						|  - #{video.title}

				//- Video thumbnail with play button overlay
				a(
					href=videoUrl
					target="_blank"
					rel="noopener noreferrer"
					class="block relative rounded-lg overflow-hidden shadow-md" +
					      " hover:shadow-xl transition-shadow bg-black group" +
					      " max-w-md"
					title="Watch video"
				)
					//- Thumbnail image
					img(
						src=video.thumbnailUrl
						alt="Video thumbnail"
						class="w-full aspect-video object-cover"
						loading="lazy"
					)

					//- Play button overlay
					div(class="absolute inset-0 flex items-center justify-center")
						div(class="bg-red-600 rounded-full p-4" +
						          " group-hover:bg-red-700 transition-colors" +
						          " shadow-lg")
							svg(
								class="w-12 h-12 text-white"
								fill="currentColor"
								viewBox="0 0 24 24"
							)
								path(d="M8 5v14l11-7z")

					//- Platform badge
					div(class="absolute top-2 right-2 px-2 py-1 rounded" +
					          " text-xs font-semibold text-white" +
					          ` ${video.platform === 'youtube' ? 'bg-red-600' : 'bg-blue-600'}`)
						if video.platform === 'youtube'
							| YouTube
						else if video.platform === 'vimeo'
							| Vimeo
						else
							= video.platform

				if video.author
					p(class="text-sm text-gray-600 mt-1") by #{video.author}
				p(class="text-xs text-gray-500 mt-2 italic") Click to watch on #{video.platform === 'youtube' ? 'YouTube' : video.platform === 'vimeo' ? 'Vimeo' : 'external site'}

		else if videoUrl.trim()
			//- Show link for unknown/unsupported platforms
			div(class="mb-6")
				h3(class="text-lg font-bold mb-3 text-gray-900") Video Link
				a(
					href=videoUrl
					target="_blank"
					rel="noopener noreferrer"
					class="text-blue-600 hover:text-blue-800 hover:underline"
				)= videoUrl
